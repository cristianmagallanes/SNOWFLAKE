CREATE OR REPLACE PROCEDURE DB_ODS_BILLING.SH_STAGING.SP_TEMP_FIX_INCREMENTAL_LOAD()
RETURNS VARCHAR(50)
LANGUAGE SQL
EXECUTE AS OWNER
AS 'BEGIN TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ADMINTOOLS_ROLE;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ADMINTOOLS_ROLE
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ADMINTOOLS_ROLE_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ADMINTOOLS_ROLE_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ADMINTOOLS_ROLE_SECTION;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ADMINTOOLS_ROLE_SECTION
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ADMINTOOLS_ROLE_SECTION_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ADMINTOOLS_ROLE_SECTION_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_PAYMENT_METHODS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_PAYMENT_METHODS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_PAYMENT_METHODS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_PAYMENT_METHODS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_ADDRESS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_ADDRESS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_ADDRESS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_ADDRESS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_GROUP_MAP;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_GROUP_MAP
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_GROUP_MAP_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_GROUP_MAP_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_STATEMENT;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_STATEMENT
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_STATEMENT_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_STATEMENT_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_PAYMENT_TERMS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_PAYMENT_TERMS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_PAYMENT_TERMS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_PAYMENT_TERMS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_MEMO;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_MEMO
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_MEMO_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_MEMO_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_EXTERNAL_PAYMENTS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_EXTERNAL_PAYMENTS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_EXTERNAL_PAYMENTS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_EXTERNAL_PAYMENTS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_NEW_RATE_SCHED_RATES;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_NEW_RATE_SCHED_RATES
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_NEW_RATE_SCHED_RATES_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_NEW_RATE_SCHED_RATES_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE_ALT_RATES;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE_ALT_RATES
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE_ALT_RATES_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE_ALT_RATES_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_RATE_SCHED_MAP;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_RATE_SCHED_MAP
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_RATE_SCHED_MAP_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_RATE_SCHED_MAP_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_XML_DOCUMENT;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_XML_DOCUMENT
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_XML_DOCUMENT_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_XML_DOCUMENT_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_USAGE_TYPES;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_USAGE_TYPES
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_USAGE_TYPES_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_USAGE_TYPES_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_MULTIPLAN_CONTRACT_INST;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_MULTIPLAN_CONTRACT_INST
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_MULTIPLAN_CONTRACT_INST_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_MULTIPLAN_CONTRACT_INST_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_STATUS_HISTORY;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_STATUS_HISTORY
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_STATUS_HISTORY_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_STATUS_HISTORY_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_BILLING_INFO;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_BILLING_INFO
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_BILLING_INFO_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_BILLING_INFO_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_GL_CODES;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_GL_CODES
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_GL_CODES_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_GL_CODES_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PAYMENT_TERMS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PAYMENT_TERMS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PAYMENT_TERMS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PAYMENT_TERMS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_PLAN_CONTRACT_STATUS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_PLAN_CONTRACT_STATUS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_PLAN_CONTRACT_STATUS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_PLAN_CONTRACT_STATUS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CASH_CREDITS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CASH_CREDITS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CASH_CREDITS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CASH_CREDITS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL_DETAIL;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL_DETAIL
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL_DETAIL_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL_DETAIL_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL_TAX_DETAIL;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL_TAX_DETAIL
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL_TAX_DETAIL_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL_TAX_DETAIL_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_WRITE_OFFS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_WRITE_OFFS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_WRITE_OFFS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_WRITE_OFFS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INST_COUPON_MAP;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INST_COUPON_MAP
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INST_COUPON_MAP_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INST_COUPON_MAP_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_BILLING_GROUP;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_BILLING_GROUP
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_BILLING_GROUP_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_BILLING_GROUP_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_PLAN;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_PLAN
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_PLAN_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_PLAN_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_COUPONS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_COUPONS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_COUPONS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_COUPONS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDITS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDITS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDITS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDITS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_DASHBOARD_USER_ROLE;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_DASHBOARD_USER_ROLE
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_DASHBOARD_USER_ROLE_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_DASHBOARD_USER_ROLE_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL_CREDIT_DETAIL;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL_CREDIT_DETAIL
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL_CREDIT_DETAIL_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL_CREDIT_DETAIL_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_INVENTORY_ITEM_RATE_SCHEDULE;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_INVENTORY_ITEM_RATE_SCHEDULE
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_INVENTORY_ITEM_RATE_SCHEDULE_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_INVENTORY_ITEM_RATE_SCHEDULE_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_INVENTORY_ITEMS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_INVENTORY_ITEMS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_INVENTORY_ITEMS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_INVENTORY_ITEMS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ORDERS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ORDERS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ORDERS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ORDERS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INST_PRODUCT_FIELDS_VAL;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INST_PRODUCT_FIELDS_VAL
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INST_PRODUCT_FIELDS_VAL_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INST_PRODUCT_FIELDS_VAL_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE_PLAN_HIST;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE_PLAN_HIST
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE_PLAN_HIST_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE_PLAN_HIST_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_SERVICES;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_SERVICES
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_SERVICES_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_SERVICES_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_SERVICES;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_SERVICES
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_SERVICES_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_SERVICES_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_CHART_OF_ACCOUNT;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_CHART_OF_ACCOUNT
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_CHART_OF_ACCOUNT_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_CHART_OF_ACCOUNT_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_LEGAL_ENTITY;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_LEGAL_ENTITY
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_LEGAL_ENTITY_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_LEGAL_ENTITY_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_COUPON_DISCOUNT_RULE_MAP;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_COUPON_DISCOUNT_RULE_MAP
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_COUPON_DISCOUNT_RULE_MAP_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_COUPON_DISCOUNT_RULE_MAP_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_MEMO_TAX_DETAIL;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_MEMO_TAX_DETAIL
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_MEMO_TAX_DETAIL_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_MEMO_TAX_DETAIL_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL_DTL_DISCOUNT_DTL;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL_DTL_DISCOUNT_DTL
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL_DTL_DISCOUNT_DTL_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_GL_DTL_DISCOUNT_DTL_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ORDER_STATUS_HISTORY;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ORDER_STATUS_HISTORY
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ORDER_STATUS_HISTORY_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ORDER_STATUS_HISTORY_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PAYMENT_REPORT;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PAYMENT_REPORT
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PAYMENT_REPORT_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PAYMENT_REPORT_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INST_DISCOUNT_RULE_MAP;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INST_DISCOUNT_RULE_MAP
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INST_DISCOUNT_RULE_MAP_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INST_DISCOUNT_RULE_MAP_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PROMOTIONS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PROMOTIONS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PROMOTIONS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PROMOTIONS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_MULTI_PLAN_CONTRACTS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_MULTI_PLAN_CONTRACTS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_MULTI_PLAN_CONTRACTS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_MULTI_PLAN_CONTRACTS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_TRANS_APPLICATION;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_TRANS_APPLICATION
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_TRANS_APPLICATION_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_TRANS_APPLICATION_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_TRANSACTION;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_TRANSACTION
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_TRANSACTION_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_TRANSACTION_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_OBJ_SUPP_FIELDS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_OBJ_SUPP_FIELDS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_OBJ_SUPP_FIELDS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_OBJ_SUPP_FIELDS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_PAYMENT_METHOD;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_PAYMENT_METHOD
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_PAYMENT_METHOD_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_PAYMENT_METHOD_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_DEBT_AGING_REPORT;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_DEBT_AGING_REPORT
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_DEBT_AGING_REPORT_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_DEBT_AGING_REPORT_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ORDER_ITEMS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ORDER_ITEMS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ORDER_ITEMS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ORDER_ITEMS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE_MASTER;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE_MASTER
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE_MASTER_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE_MASTER_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_STATUS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_STATUS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_STATUS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_STATUS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_SUPP_FIELD_VALS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_SUPP_FIELD_VALS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_SUPP_FIELD_VALS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_SUPP_FIELD_VALS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ADMINTOOLS_SECTION;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ADMINTOOLS_SECTION
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ADMINTOOLS_SECTION_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ADMINTOOLS_SECTION_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_DISCOUNT_RULES;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_DISCOUNT_RULES
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_DISCOUNT_RULES_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_DISCOUNT_RULES_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_MEMO_DETAIL;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_MEMO_DETAIL
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_MEMO_DETAIL_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_MEMO_DETAIL_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_DASHBOARD_USER;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_DASHBOARD_USER
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_DASHBOARD_USER_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_DASHBOARD_USER_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_INVENTORY_ITEM_RATE_SCHED_RATE;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_INVENTORY_ITEM_RATE_SCHED_RATE
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_INVENTORY_ITEM_RATE_SCHED_RATE_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_INVENTORY_ITEM_RATE_SCHED_RATE_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ADMINTOOLS_CLIENT_SECTION;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ADMINTOOLS_CLIENT_SECTION
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ADMINTOOLS_CLIENT_SECTION_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ADMINTOOLS_CLIENT_SECTION_ALL
    );

TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_APMEVENTS_APMEVENTDATA;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_APMEVENTS_APMEVENTDATA
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_APMEVENTS_APMEVENTDATA_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_APMEVENTS_APMEVENTDATA_ALL
    );

TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_REFERENCEDATA602;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_REFERENCEDATA602
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_REFERENCEDATA602_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_REFERENCEDATA602_ALL
    );

TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_STAGINGDATA;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_STAGINGDATA
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_STAGINGDATA_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_STAGINGDATA_ALL
    );

TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_TRANSDATA;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_TRANSDATA
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_TRANSDATA_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_TRANSDATA_ALL
    );

TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_TRANSDATAINVOICELIST;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_TRANSDATAINVOICELIST
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_TRANSDATAINVOICELIST_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_TRANSDATAINVOICELIST_ALL
    );

TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_UNMATCHSTAGINGDATA;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_UNMATCHSTAGINGDATA
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_UNMATCHSTAGINGDATA_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_APM_PAYMENTS_UNMATCHSTAGINGDATA_ALL
    );



TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE_BILLABILITY_BY_BILLDATE_M;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE_BILLABILITY_BY_BILLDATE_M
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE_BILLABILITY_BY_BILLDATE_M_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PLAN_INSTANCE_BILLABILITY_BY_BILLDATE_M_ALL
    );

TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_REASONS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_REASONS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_REASONS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_REASONS_ALL
    );

TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_APPLICATION;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_APPLICATION
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_APPLICATION_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CREDIT_APPLICATION_ALL
    );

TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_ADDRESS_W_TYPE;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_ADDRESS_W_TYPE
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_ADDRESS_W_TYPE_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_ADDRESS_W_TYPE_ALL
    );

TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ALL_PAYMENTS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ALL_PAYMENTS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ALL_PAYMENTS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ALL_PAYMENTS_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ALL_INVOICES;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ALL_INVOICES
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ALL_INVOICES_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ALL_INVOICES_ALL
    );
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_PLAN_CONTRACTS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_PLAN_CONTRACTS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_PLAN_CONTRACTS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_ACCT_PLAN_CONTRACTS_ALL
    );
    
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_GL_CODE_SERVICE_MAP;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_GL_CODE_SERVICE_MAP
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_GL_CODE_SERVICE_MAP_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_GL_CODE_SERVICE_MAP_ALL
    );
    
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PAYMENTS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PAYMENTS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PAYMENTS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_PAYMENTS_ALL
    );
    
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_REFUND_DETAIL;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_REFUND_DETAIL
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_REFUND_DETAIL_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_REFUND_DETAIL_ALL
    );
    
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_REFUND_TAX_DETAIL;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_REFUND_TAX_DETAIL
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_REFUND_TAX_DETAIL_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_REFUND_TAX_DETAIL_ALL
    );
    
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_REFUNDS;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_REFUNDS
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_REFUNDS_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_REFUNDS_ALL
    );  
    
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_USAGE;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_USAGE
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_USAGE_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_USAGE_ALL
    );  
    
TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_VERISURE_DATAEXTEND_SUMMARY_REPORT;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_VERISURE_DATAEXTEND_SUMMARY_REPORT
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_VERISURE_DATAEXTEND_SUMMARY_REPORT_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_VERISURE_DATAEXTEND_SUMMARY_REPORT_ALL
    );     

TRUNCATE DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_PLAN_SUPP_FIELDS_VAL;
INSERT INTO DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_PLAN_SUPP_FIELDS_VAL
SELECT *
FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_PLAN_SUPP_FIELDS_VAL_ALL
WHERE DH_LOAD_DATE = (
        SELECT MAX(DH_LOAD_DATE)
        FROM DB_ODS_BILLING.SH_STAGING.SRC_ARIA_CLIENT_PLAN_SUPP_FIELDS_VAL_ALL
    );        
END';